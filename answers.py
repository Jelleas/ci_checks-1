import numpy as np
import pandas as pd
import spacy as spacy

from numpy import nan
from pandas import DataFrame, Series


def test_1(mse_random):
    print("Testing mse value: ", end='')
    assert mse_random > 3.0, "expected mse value > 3.0"
    assert mse_random < 4.0, "expected mse value < 4.0"
    print("success!")


def test_2(mse_mean, mse_cf_item_based):
    print("Testing mse value: ", end='')
    assert mse_mean < mse_cf_item_based, f"expected mse > {mse_cf_item_based:.4f}"
    print('success!')


def test_4(mse_genres):
    print("Testing mse value: ", end='')
    assert mse_genres > 0.8 and (
        mse_genres < 0.9), "expected mse value around 0.84"
    print("success!")


def test_7(bag_of_words):
    def _test_series(student_answer, solution):
        assert type(
            student_answer) == Series, "Expected your answer to be of type Series"
        assert set(student_answer.index) == set(
            solution.index), f"solution index: {solution.index}, your index: {student_answer.index}"
        for word in solution.index:
            assert solution[word] == student_answer[
                word], f"Expected {solution[word]} at '{word}' but found {student_answer[word]}"

    nlp = spacy.load('en_core_web_sm')

    print(
        "Testing bag of words with a text that does NOT contain punctuation: ",
        end="")
    solution = Series([1, 1, 1], index=['duck', 'cross', 'road']).astype(
        "int64")
    doc = nlp("the duck crossed the road again and again")
    student_answer = bag_of_words(doc)
    _test_series(student_answer, solution)
    print("Succes!")

    print("Testing bag of words with a text that does contain punctuation: ",
          end="")
    solution = Series([1, 1, 1], index=['duck', 'cross', 'road']).astype(
        "int64")
    doc = nlp("the duck crossed, the road again and again.")
    student_answer = bag_of_words(doc)
    _test_series(student_answer, solution)
    print("Succes!")


def test_8(doc, bag_of_words, term_frequency, nlp):
    print(
        "Testing term_frequency on the text 'english english english word word random': ",
        end="")
    solution = Series([0.5, 0.3333333333333333, 0.16666666666666666],
                      index=['english', 'word', 'random']).astype("float64")

    def _test_series(student_answer, solution):
        assert type(
            student_answer) == Series, "Expected your answer to be of type Series"
        assert set(student_answer.index) == set(
            solution.index), f"solution index: {solution.index}, your index: {student_answer.index}"
        for word in solution.index:
            assert solution[word] == student_answer[
                word], f"Expected {solution[word]} at '{word}' but found {student_answer[word]}"

    doc = nlp("english english english word word random")
    bag = bag_of_words(doc)
    student_answer = term_frequency(bag)
    _test_series((student_answer * 100).map(int), (solution * 100).map(int))
    print("Succes!")


def test_9(nlp, bag_of_words, inverse_document_frequency):
    print("Testing inverse document frequency: ", end="")

    def _test_series(student_answer, solution):
        assert type(
            student_answer) == Series, "Expected your answer to be of type Series"
        assert set(student_answer.index) == set(
            solution.index), f"solution index: {solution.index}, your index: {student_answer.index}"
        for word in solution.index:
            assert solution[word] == student_answer[
                word], f"Expected {solution[word]} at '{word}' but found {student_answer[word]}"

    solution = Series(
        [1.0986122886681098, 0.0, 0.4054651081081644, 1.0986122886681098],
        index=['english', 'random', 'roof', 'word']).astype("float64")

    bag1 = bag_of_words(nlp("english english english word word random"))
    bag2 = bag_of_words(nlp("roof roof random"))
    bag3 = bag_of_words(nlp("roof random"))
    student_answer = inverse_document_frequency([bag1, bag2, bag3])
    _test_series(student_answer, solution)
    print("Succes!")


def test_11(nlp, bag_of_words, tf_idf):
    idf = pd.read_pickle('./data/idf.pkl')

    def _test_series(student_answer, solution):
        assert type(
            student_answer) == Series, "Expected your answer to be of type Series"
        assert set(student_answer.index) == set(
            solution.index), f"solution index: {solution.index}, your index: {student_answer.index}"
        for word in solution.index:
            assert solution[word] == student_answer[
                word], f"Expected {solution[word]} at '{word}' but found {student_answer[word]}"

    print("Testing tf_idf: ", end="")
    solution = Series(
        [0.9700282369019263, 0.0649750369302339, 0.4454819004385067],
        index=['english', 'word', 'random']).astype("float64")

    bag = bag_of_words(nlp("english english english word word random"))
    student_answer = tf_idf(bag, idf)
    _test_series(student_answer, solution)
    print("Succes!")


def test_16(frame):
    print("Testing: ", end="")

    frame = frame.astype("float64")
    solution = DataFrame([[1.0, 0.33510586690428007, 0.44173321095505513,
                           0.7517859342501927, 0.5248965400138786],
                          [0.33510586690428007, 1.0, 0.7453350795732844,
                           0.3677176990934737, 0.6501385254601899],
                          [0.44173321095505513, 0.7453350795732844, 1.0,
                           0.48254533689518175, 0.7573737418959072],
                          [0.7517859342501927, 0.3677176990934737,
                           0.48254533689518175, 1.0, 0.580948308759836],
                          [0.5248965400138786, 0.6501385254601899,
                           0.7573737418959072, 0.580948308759836, 1.0]],
                         columns=['recommender', 'warren', 'biden',
                                  'machinelearning', 'brexit'],
                         index=['recommender', 'warren', 'biden',
                                'machinelearning', 'brexit'])
    print(type(frame))
    pd.testing.assert_frame_equal(frame, solution)
    print("Success")


def test_18(compute_vector, nlp_headlines, similarity):
    print("Testing compute_vector: ", end="")

    utility = pd.DataFrame([compute_vector(doc) for _, doc in
                            nlp_headlines.items()], index=nlp_headlines.index)

    solution = DataFrame([[-0.24354000389575958, -0.10503039956092834,
                           0.16458980236202478, -0.02735000252723694,
                           0.1533532038331032, 0.05575538077391684,
                           0.041678205132484436, -0.0041108650621026754,
                           0.04923040270805359, 0.6948763906955719,
                           0.09622720032930374, -0.09305060058832168,
                           0.16895140148699284, -0.1003682017326355,
                           -0.16434200704097748, 0.1205000028014183,
                           -0.07764860317111015, 1.3800600051879883,
                           -0.08329299837350845, -0.15266580507159233,
                           0.13729600012302398, -0.10040340051054955,
                           0.16526619866490364, 0.013062801957130433,
                           0.11363000124692917, 0.03133419808000326,
                           0.0873539924621582, -0.07740339934825897,
                           0.21893751611933113, -0.09103615861386061,
                           -0.15424400568008423, -0.1071008026599884,
                           0.35689480900764464, -0.007586200535297394,
                           -0.04938899874687195, -0.1460766039788723,
                           0.07536000609397889, 0.08057678518816828,
                           -0.13091800063848497, -0.03246199488639832,
                           -0.038217999041080475, -0.04639619886875153,
                           -0.20890040472149848, 0.29532879665493966,
                           -0.09007939994335175, 0.158534599468112,
                           0.08473999798297882, 0.05456219725310803,
                           0.20203020349144934, 0.16942199766635896,
                           0.1321495935320854, -0.054051398858428,
                           -0.1091575987637043, 0.35454600155353544,
                           -0.3051939994096756, -0.16224560067057608,
                           -0.0092320054769516, 0.0006188053637742996,
                           -0.24994979947805404, 0.03495140299201012,
                           0.03962200582027435, 0.1897596050053835,
                           0.13702200055122377, -0.010595998167991639,
                           0.3187273949384689, 0.2116288013756275,
                           -0.06548360399901867, 0.14272980019450188,
                           0.02675739675760269, -0.18651120513677596,
                           -0.1269614001736045, -0.2623560011386871,
                           0.12555820494890213, -0.05522577995434404,
                           0.10448819790035486, -0.07509339898824692,
                           -0.055075600370764734, -0.0028474017977714538,
                           -0.023771598190069198, 0.3783780038356781,
                           -0.12761800587177277, 0.14602335402742028,
                           0.2847200036048889, -0.2256846010684967,
                           -0.12772460095584393, -0.2457411952316761,
                           -0.46428799331188203, 0.16880440525710583,
                           0.12028040140867233, 0.3094707950949669,
                           -0.1559407999739051, -0.13193581495434045,
                           -0.2519876003265381, -0.12895660139620305,
                           0.3121678091585636, -0.0032519936561584474,
                           0.3069039940834045, -0.037794599682092665,
                           0.03431799709796905, -0.3137349963188171,
                           -0.1673052042722702, -0.38564600646495817,
                           -0.14796599745750427, -0.06511001754552126,
                           0.07029919475317001, -1.4674999713897705,
                           -0.00522879883646965, 0.19104339852929114,
                           -0.05475399941205979, -0.029391001164913177,
                           0.09160899892449378, -0.12383760102093219,
                           0.02084040194749832, -0.16388599574565887,
                           -0.10832319781184196, -0.004828997701406479,
                           0.05005559921264648, 0.12935859709978104,
                           -0.1480120036751032, 0.11499600112438202,
                           0.07872809381733532, 0.007277996838092804,
                           -0.0682532574981451, -0.05129920095205307,
                           -0.05584639608860016, 0.08094339724630117,
                           0.1388084039092064, 0.1777282055467367,
                           0.23704480230808259, -0.12599799931049346,
                           0.06972000151872634, -0.14387579634785652,
                           0.07827200293540955, -0.13698199838399888,
                           0.02485400140285492, 0.17990200221538544,
                           0.03552879840135574, 0.1109019935131073,
                           0.1156379982829094, 0.05444579496979714,
                           -0.013287600129842758, -0.3103393971920013,
                           0.0072720006108284, -0.1349620044231415,
                           -0.034160396084189415, -0.20814999639987947,
                           -0.1372988022863865, -0.07565899919718504,
                           -0.010957799851894379, 0.08147040009498596,
                           0.20594599843025208, -0.25278201401233674,
                           0.004080000519752503, 0.25443194806575775,
                           -0.04895400069653988, 0.12471199780702591,
                           0.09739359878003598, -0.10812860578298569,
                           0.20677700340747834, 0.1634513981640339,
                           -0.11669659912586212, 0.032272796332836154,
                           -0.052688002586364746, -0.21773599684238434,
                           -0.2309632796328515, -0.15429934114217758,
                           -0.10359799563884735, -0.08338999599218369,
                           0.09244540110230445, 0.01496400088071823,
                           0.002932496089488268, 0.2290399968624115,
                           0.11380620300769806, -0.11600800156593323,
                           0.1676281988620758, -0.017470259009860455,
                           0.18622220121324062, 0.3430948078632355,
                           0.2404320001602173, 0.2312403991818428,
                           0.022344399988651276, -0.027267998456954955,
                           0.11971339657902717, -0.1865220010280609,
                           -0.05950399674475193, 0.0005679965019226074,
                           -0.17092799730598926, 0.006090600788593292,
                           -0.09027000069618225, -0.14278779719024898,
                           -0.06368638053536416, -0.15468740314245225,
                           -0.06998399868607522, 0.07511899769306182,
                           -0.12217600345611572, -0.05773179680109024,
                           -0.172553800791502, -0.008238600008189679,
                           -0.06304399967193604, 0.15243860445916652,
                           -0.1061170019209385, -0.20964726023375987,
                           0.018881994485855102, 0.1327767802402377,
                           -0.2141633987426758, -0.08218280225992203,
                           0.03495400249958038, -0.046116401255130765,
                           0.030543800443410873, 0.10022079944610596,
                           -0.11079999804496765, -0.23839940130710602,
                           0.030030598491430284, -0.229475998878479,
                           0.010651795566082001, -0.07275259345769883,
                           -0.02313939668238163, 0.2316418007016182,
                           -0.3532839953899384, -0.1490271992981434,
                           0.2546339988708496, 0.037497396022081374,
                           0.10842680595815182, 0.11669840458780527,
                           -0.001590198278427124, 0.11943840235471725,
                           0.11349019855260849, -0.13060920238494872,
                           0.04816659688949585, 0.2633067935705185,
                           -0.3002259999513626, -0.06701799631118774,
                           -0.19187079966068268, -0.1827514052391052,
                           0.1430275984108448, 0.14691099971532823,
                           0.06892239898443223, 0.13906400203704833,
                           -0.03690700009465218, 0.14991819858551025,
                           0.13242639750242233, -0.14517591819167136,
                           -0.02317800223827362, -0.1719562068581581,
                           -0.007635398209095002, -0.059726005792617796,
                           -0.12004202250391245, 0.010651999711990356,
                           -0.19632339775562285, 0.04379599392414093,
                           0.02474060207605362, 0.0391058012843132,
                           -0.09930639714002609, 0.14503840021789074,
                           0.04274160265922546, -0.3021700020879507,
                           -0.021069996803998948, -0.1162997990846634,
                           -0.04739700555801392, -0.12636399865150452,
                           0.15829899907112122, -0.15424980446696282,
                           0.053407760057598355, 0.19316380135715008,
                           -0.1191825432702899, -0.25691199898719785,
                           -0.01948160380125046, 0.2360174000263214,
                           0.8276440024375915, 0.08834218103438615,
                           -0.1828120019286871, -0.1912040024995804,
                           -0.0005246032029390335, -0.10376600027084351,
                           -0.11504079923033714, 0.008889356162399054,
                           -0.01351412022486329, -0.00887019969522953,
                           0.03046720176935196, -0.23221001029014587,
                           0.05560200810432434, -0.061825919523835184,
                           0.2787720009684563, -0.34274600744247435,
                           -0.2885020047426224, -0.29171199798583985,
                           -0.1700658030807972, 0.03609579876065254,
                           0.08851900026202202, -0.1335951991379261,
                           -0.35399179458618163, -0.16836580038070678,
                           0.04622499644756317, 0.4130079984664917,
                           0.07063286174088716, -0.08041599988937378,
                           0.10173799991607665, 0.17259300351142884,
                           0.08576799631118774, 0.0177079975605011],
                          [-0.025088699907064436, 0.07115349993109703,
                           0.07890740018337965, 0.01355549916625023,
                           -0.0479521194472909, -0.021503420360386372,
                           0.18599840779206717, -0.16496350094676018,
                           0.14056620076298715, 0.7992040038108825,
                           -0.03318800255656242, -0.14765936720068568,
                           -0.015423901192843915, -0.04637949783354998,
                           -0.22662700414657594, 0.08173469565808773,
                           0.012231701239943504, 0.011853896826505662,
                           -0.1132189005613327, -0.06754480302333832,
                           0.007481608493253589, 0.1982499048113823,
                           0.2602545954287052, -0.16529360078275204,
                           0.017924498487263917, 0.02343760132789612,
                           -0.3236070014536381, 0.12349379956722259,
                           -0.09251310154795647, -0.08725550100207329,
                           0.0955470010638237, 0.10152599662542343,
                           -0.06737510114908218, -0.02012230074033141,
                           0.031049700826406477, -0.030554402340203523,
                           -0.2009270042181015, 0.09923436553217471,
                           -0.1769540026783943, -0.12321159802377224,
                           0.14766141939908267, 0.1251403033733368,
                           -0.023549701506271958, -0.11990079879760743,
                           -0.028895300067961215, 0.014012280525639654,
                           -0.04741416231263429, -0.08863649694249034,
                           0.010360296070575713, 0.008489739755168558,
                           0.01558039765805006, 0.04621190121397376,
                           -0.07204630058258772, 0.008201000094413758,
                           -0.04980566017329693, -0.042019200325012204,
                           -0.16317814253270627, 0.011181697994470597,
                           -0.07349729808047414, 0.006415581796318293,
                           -0.21577169969677926, 0.06597830206155778,
                           -0.11137969829142094, -0.1399649992585182,
                           0.05609982467431109, -0.0846125977113843,
                           -0.12860339898616074, 0.14292329587042332,
                           0.1225180022418499, -0.1526951003819704,
                           -0.023583595640957355, -0.007167998701334,
                           0.03962370082736015, 0.0634625990409404,
                           0.0325222983956337, -0.06545040234923363,
                           0.009949499368667602, 0.1560738030821085,
                           0.05283469930291176, -0.04494570065289736,
                           0.014422999322414398, 0.07262879461050034,
                           -0.028318800777196885, 0.0376315001398325,
                           -0.06038479804992676, -0.08873800039291382,
                           0.5908753946423531, -0.1670503981411457,
                           0.09132260084152222, -0.010021400824189185,
                           -0.10078669674694538, 0.1464639963582158,
                           0.060187700763344766, -0.10800660103559494,
                           0.17826900258660316, -0.0206933019682765,
                           0.08220919892191887, 0.08026437982916831,
                           -0.07725989799946546, -0.08747849874198436,
                           0.11944710109382868, -0.05742879994213581,
                           0.04524400122463703, -0.029286897182464598,
                           -0.0956040007993579, -0.5632090009748936,
                           0.017844197899103166, -0.18242519907653332,
                           -0.09417329709976911, 0.09555240124464034,
                           0.09266639910638333, 0.09754838244989514,
                           0.024168603122234344, -0.06635599918663501,
                           -0.029100002348423006, 0.018736099265515803,
                           0.19558589532971382, -0.0664719969034195,
                           -0.072416802495718, 0.06348746847361326,
                           -0.0822168979793787, 0.11393240299075842,
                           -0.009010140504688024, 0.10961230099201202,
                           0.0167728990316391, -0.06875840369757498,
                           0.029524699598550797, 0.016226997971534728,
                           0.05794190131127834, 0.18174089789390563,
                           -0.11346500217914582, 0.009641997516155243,
                           0.15635790266096591, -0.22030580192804336,
                           -0.09860599637031556, 0.0012769967317581177,
                           -0.10888288104906678, 0.09176230058073997,
                           0.11263462333008648, -0.14557249695062638,
                           -0.7777830064296722, -0.05037510134279728,
                           -0.04293779730796814, -0.007413039519451559,
                           -0.03597179781645536, -0.031696200370788574,
                           0.2319444978609681, -0.08296029455959797,
                           -0.1258762940764427, -0.10590219823643565,
                           0.06698750033974647, -0.2765821009874344,
                           -0.16181664732284845, 0.01792359836399555,
                           0.15904300063848495, -0.07284322738414631,
                           0.0685635007917881, -0.07952200165018439,
                           -0.06160900071263313, 0.01795240119099617,
                           0.1631024032831192, 0.10075879637151956,
                           -0.1724001981317997, 0.17627839669585227,
                           0.1315379962325096, -0.04596460089087486,
                           -0.015985100716352462, 0.016647002100944518,
                           0.00651484695263207, 0.04264520090073347,
                           -0.007438899390399456, 0.04747730223461986,
                           -0.04307750165462494, 0.017159401997923852,
                           0.03648570328950882, -0.1380133384373039,
                           0.04195560067892075, 0.19202210952644236,
                           0.10693240128457546, 0.24932270012795926,
                           0.12408200213685631, 0.08700890280306339,
                           0.021214301139116286, -0.027107498981058596,
                           0.09522300059907138, 0.1087407998740673,
                           -0.07529129160102457, -0.020995798520743847,
                           -0.1605695031583309, 0.04431053902953863,
                           0.0150852020829916, 0.08936577909626067,
                           -0.11431880220770836, -0.08178100138902664,
                           0.027980002760887145, 0.021095719747245313,
                           -0.06005046125501394, 0.1298271007835865,
                           0.2259665025398135, -0.18294460345059632,
                           0.05642399936914444, -0.12096350574865937,
                           0.1328689992427826, -0.22737519964575767,
                           -0.029163993895053864, 0.020339518738910555,
                           0.03128839954733849, -0.1248209998011589,
                           -0.19964500069618224, -0.12915400080382824,
                           0.05306269824504852, 0.2519949972629547,
                           0.08789919912815095, 0.3058809978887439,
                           0.12498210184276104, -0.030188094824552536,
                           -0.06387330070137978, 0.000901101902127266,
                           -0.031080997362732888, 0.10999619923532009,
                           -0.11043869946151971, 0.2623960018157959,
                           -0.042709799110889436, 0.054562750086188314,
                           0.06718400083482265, 0.10913109928369522,
                           -0.19391120336949824, -0.0806948823388666,
                           -0.065834697522223, -0.08147289967164398,
                           0.023531490517780185, 0.07484949002973736,
                           -0.02296821815543808, -0.05782352131791413,
                           -0.16225529834628105, -0.11379189938306808,
                           -0.007991899643093348, -0.05561290066689253,
                           -0.002051498182117939, 0.14117274462478235,
                           -0.04980870056897402, -0.12060150429606438,
                           0.14220219813287258, -0.16290220245718956,
                           -0.049403699673712255, 0.00625869669020176,
                           0.14529649764299393, 0.1221471980214119,
                           -0.07225279733538628, -0.20561789833009242,
                           0.20929879769682885, -0.0341315969824791,
                           -0.0861118701286614, -0.07809930071234703,
                           -0.06876380182802677, -0.18724790252745152,
                           -0.15428631412796676, -0.13498082344594878,
                           0.060459397919476035, -0.013191100955009461,
                           -0.0032116007059812546, -0.005538200959563255,
                           -0.09016890227794647, 0.11533000320196152,
                           -0.066500698402524, -0.18526279777288437,
                           0.12697579972445966, -0.03582410141825676,
                           -0.13195500075817107, 0.15025459602475166,
                           -0.07804270219057799, 0.06297139897942543,
                           0.06615880057215691, 0.07657900264021009,
                           0.004797590197995305, 0.05639429995790124,
                           0.3028075424954295, -0.03932269886136055,
                           -0.08544299677014351, -0.08641460351645947,
                           -0.14283859953284264, -0.04182215015171096,
                           -0.10292369872331619, 0.14380869902670385,
                           -0.0010498974472284317, -0.02723900377750397,
                           0.025155201181769372, 0.15352799743413925,
                           -0.2299872943200171, 0.05068439915776253,
                           0.09508590009063482, -0.005011000484228134,
                           0.04240849912166596, 0.0065541015937924385,
                           0.13047479949891566, -0.009059396386146546,
                           0.2042955979704857, -0.1364085404551588,
                           -0.13254530169069767, -0.06710389778017997],
                          [0.00024064963111992586, 0.050869271836497566,
                           0.061507358300414955, 0.06158744984052398,
                           -0.01019745370881124, -0.22820737974887545,
                           0.021245454014702278, -0.02165154672481797,
                           0.0769736340100115, 1.490700905973261,
                           -0.03810554539615458, -0.03687496980207718,
                           -0.0854129996150732, 0.19355144893581216,
                           -0.08272191475738179, 0.0737494474107569,
                           -0.06369881126606329, 0.34186709265817294,
                           -0.15536756288598885, 0.24888909269462933,
                           0.015170002525502985, 0.03374581987207586,
                           0.2726168138059703, -0.038924633440646256,
                           0.09363736254586415, 0.017031816173006187,
                           -0.2097661786458709, -0.09636181728406386,
                           -0.1234645437110554, 0.15096800063144078,
                           0.1528770916841247, 0.03779254515062679,
                           0.03823127055710012, -0.08737090839581056,
                           -0.03401572528210553, 0.02879567181860859,
                           -0.04195827347311107, -0.13098545575683768,
                           -0.11150610065934333, -0.04213206118650057,
                           0.07366527278314937, 0.1059136377139525,
                           0.02247991277412935, 0.010646180334416304,
                           0.014283455230972984, -0.03492272442037409,
                           0.06127872724424709, -0.1134030009535226,
                           0.02912991155277599, 0.006509451703591781,
                           0.021832090040499515, 0.12864045400849797,
                           0.023810817098075695, -0.0601151811636307,
                           0.0616084560751915, 0.04408727332272313,
                           -0.16913381828503174, 0.13662172583016483,
                           0.0968864533034238, -0.01447445425120267,
                           -0.16985272954810748, 0.22469345039942049,
                           -0.03906745489009402, -0.0052592700177972965,
                           0.08346893211869015, -0.016073454002087765,
                           -0.06560636514967139, 0.05721577294389135,
                           0.08779891004616563, -0.11424627019600435,
                           0.03433472663164139, 0.15092091194607996,
                           0.07731390778313983, -0.06386209054934708,
                           -0.023223089223558254, -0.0054890899495645,
                           -0.03786491382528435, -0.024367094547911125,
                           0.10520556767005473, 0.038124273446473206,
                           -0.10245181755586104, 0.01494686913660685,
                           -0.08400817960500717, 0.02244345225732435,
                           -0.041776271028952164, 0.052133610895411533,
                           0.28315090997652576, -0.10855618737299334,
                           0.19308427518064325, -0.08282845602794127,
                           -0.047322852156040346, 0.05782508867030794,
                           0.0217700024897402, 0.04515935920856216,
                           -0.0945568172769113, -0.10603363795036619,
                           0.018795543773607773, -0.03337510222230445,
                           0.01641272846609354, -0.1841254545883699,
                           0.10005890916694295, -0.01821727322583849,
                           -0.037688274613835594, -0.06765848330476067,
                           -0.07622418451038274, -0.8317699865861372,
                           -0.04474263841455633, -0.1362180550879037,
                           -0.12248836525461891, 0.07450945506041701,
                           0.015026456930420616, 0.0353365908800201,
                           -0.032338729297572914, -0.018217635594985702,
                           -0.0005116381428458474, -0.01541063595901836,
                           0.11834846293045716, -0.030113451352173633,
                           -0.0954590920697559, -0.09331120584498752,
                           -0.11344654654914682, 0.07972454076463525,
                           0.09263636104085228, 0.11877091770822351,
                           -0.024186820807782086, 0.07381729072552513,
                           0.05227346616712483, 0.18963017856532877,
                           -0.00617157934572209, 0.1024385429918766,
                           0.0053942288399081335, 0.06320999833670529,
                           0.005491455000909892, -0.20873872868039392,
                           -0.03898181834004142, -0.06677981940182773,
                           0.006481837057931857, 0.04834845187989148,
                           0.027706361629746178, -0.0794802734797651,
                           -0.6388509185476736, -0.04673863337798552,
                           0.18453261074186725, -0.0013937266035513444,
                           0.18237072771245783, -0.09184113657101989,
                           0.013595456426793879, 0.12205000221729279,
                           -0.01765999604355205, 0.08634109287099405,
                           -0.029889180748300118, -0.2607629094272852,
                           -0.03159713681617921, 0.07731217975643548,
                           0.11054818603125485, 0.10166388907766138,
                           -0.035166633908044205, 0.0011999972841956399,
                           -0.03658509389920668, 0.15059454603628677,
                           0.04760055675763975, 0.07449545643546364,
                           -0.02023909240961075, 0.13295208408751272,
                           -0.0033245486291972074, -0.09785927341065624,
                           0.10957936671647159, -0.11970809034325859,
                           -0.03340754776515744, 0.028321001678705215,
                           0.14118890904567458, 0.14828210169534115,
                           -0.003666362301869826, 0.08098241210576486,
                           -0.0833946717903018, -0.04447290910915895,
                           -0.002753636376424269, 0.14092609362507408,
                           0.08639254556460814, 0.14082618176259779,
                           0.21859388044950637, -0.02471476374194026,
                           -0.01013754511421377, -0.07963654094121674,
                           0.18261608955535022, 0.18105567183176224,
                           0.057921999049457634, 0.0040000006556510925,
                           -0.1070909093726765, 0.08808454329317267,
                           0.026000727306712757, -0.01060672713951631,
                           0.0640311830423095, -0.037960729731077496,
                           0.06781145676293156, 0.18162636255676096,
                           -0.11076863550327042, 0.06232945316217162,
                           0.037204907699064774, -0.049682639708573166,
                           0.08271718092940071, 0.020985446193001488,
                           0.110530728304928, -0.09416409133171494,
                           0.09521154483610933, 0.029561743796379727,
                           -0.18814463981173254, -0.11131536232476885,
                           -0.017455863470042295, -0.049040820110927925,
                           0.004899637096307494, 0.1844298162243583,
                           -0.016956909813664177, 0.11140081658959389,
                           0.08363758484748277, 0.23211399872194638,
                           0.02706618183715777, 0.11160038254985755,
                           -0.10486772791905836, 0.18192263616418297,
                           -0.101470908658071, 0.011541813611984253,
                           -0.1799748194488612, 0.007482729174874045,
                           -0.010896184989674524, 0.008279453963041306,
                           0.023347360843961888, -0.09678604917479045,
                           -0.13719445128332486, 0.05528436194766651,
                           0.1723318174481392, 0.14587345312942157,
                           0.0014313650740818543, -0.006268134594640948,
                           -0.1352272697470405, -0.042339999567378654,
                           0.05408445559442043, 0.06616818363016302,
                           -0.06959597482769327, 0.10646909001198682,
                           -0.013449453494765541, -0.22260800308801912,
                           -0.06634908643635837, 0.025201782076196236,
                           0.06084281951189041, -0.12212936410849745,
                           -0.1086470042778687, 0.025790181349624287,
                           -0.09575045125728304, -0.07800909402695569,
                           0.14191390946507454, 0.08893500438055278,
                           -0.09382641628723253, -0.15086154707453467,
                           -0.11904654643413695, 0.1048236374150623,
                           -0.09615946459499272, -0.08888926919793118,
                           -0.1534660912372849, -0.10470499843358994,
                           -0.0817369981245561, 0.04107454486868598,
                           -0.02494390918449922, 0.20149863646789032,
                           0.10258181528611617, -0.18993836302648892,
                           -0.006944726559926163, -0.0505858182229779,
                           0.039420912211591545, 0.19310817732052368,
                           0.17913781834596937, -0.007678688757798888,
                           -0.13592326945879243, 0.12918869803913616,
                           0.02730572714724324, 0.16745945557274602,
                           0.2572313938289881, 0.010315017928157678,
                           -0.01879100027409467, -0.0024690949781374497,
                           -0.08452350157313049, -0.16624318063259125,
                           -0.13698654621839523, 0.19838399846445431,
                           0.07640318470922383, -0.061154819686304436,
                           -0.11244445328008044, -0.014589999209750782,
                           0.04306636547500437, 0.15602199868722397,
                           0.05838436565615914, 0.09046377724205906,
                           -0.003899455747821114, -0.07190745560960336,
                           0.15219100192189217, 0.11228936385702003,
                           0.14846445044333284, 0.020758456127210098,
                           -0.06148736382072622, -0.02780472622676329],
                          [-0.09741560323163867, 0.10033750236034393,
                           -0.0531626814045012, -0.2341169998049736,
                           -0.19531536186113954, 0.02411549985408783,
                           0.021680599823594094, 0.25057276759762315,
                           0.1947399988770485, 1.055231013894081,
                           -0.06952699720859527, 0.052172408811748026,
                           0.05923180021345616, 0.014775202423334122,
                           -0.027237601950764655, 0.11989620169624686,
                           -0.11014840267598629, 1.2410819798707962,
                           -0.03297309763729572, -0.10887429770082235,
                           0.08887490034103393, -0.07556080017238856,
                           0.06496339738368988, 0.05500509291887283,
                           0.20502100065350531, 0.09658100232481956,
                           0.2578379988670349, 0.03939499631524086,
                           0.10679551218636334, -0.114644321706146,
                           -0.18304839953780175, 0.13348932741209865,
                           0.16052182156126946, -0.1330859012901783,
                           0.07045099884271622, 0.07513309977948665,
                           0.0022950995713472365, 0.14296999871730803,
                           -0.07825676091015339, -0.016005999594926833,
                           -0.03157609943300486, -0.04819990135729313,
                           -0.13421090357005597, 0.18234799951314926,
                           -0.11396269872784615, -0.07857029633596539,
                           -0.17960459794849157, 0.06921999752521515,
                           -0.1627565935254097, 0.12571099754422904,
                           0.12696377905085682, 0.12812199741601943,
                           -0.0802393987774849, 0.23033699840307237,
                           -0.3045504979789257, 0.024299400486052038,
                           -0.061450099403737114, 0.06803989950567484,
                           0.039455799385905266, 0.26473419889807703,
                           0.08766120150685311, 0.20208999924361706,
                           0.013579102756921202, -0.11286596804857255,
                           0.23079819642007351, 0.10589430294930935,
                           -0.054830200597643854, -0.046373100206255916,
                           0.07147356965579092, -0.06527360416948795,
                           -0.05872839977964759, 0.008216099068522453,
                           0.1327237978577614, -0.18665120005607605,
                           0.11168149821460246, 0.08253789907321334,
                           -0.04719960942165926, -0.16802549809217454,
                           -0.02777940221130848, 0.33337999880313873,
                           -0.2872184984385967, -0.004304800182580948,
                           0.12152200192213058, -0.16408479921519756,
                           0.11400067978538572, -0.10263899564743043,
                           -0.2974085268797353, 0.017048203200101853,
                           0.0012608195189386605, 0.0037873990833759306,
                           -0.21996779814362527, 0.03631059071049094,
                           -0.1805352997034788, 0.02045489866286516,
                           0.17008170429617167, -0.10254110097885132,
                           -0.050710099190473555, 0.11810690052807331,
                           0.045243002474308014, 0.04773340094834566,
                           0.04893130250275135, -0.08629640284925699,
                           -0.09122800961486063, 0.09733749851584435,
                           0.17083971482352353, -0.7573919907212258,
                           0.07989069800823927, 0.01500750072300434,
                           0.017937196418642998, 0.05465999692678451,
                           0.17549029774963856, -0.1177804971113801,
                           0.001688778051175177, -0.19959719926118852,
                           -0.15168629847466947, 0.13997660167515277,
                           -0.07538069859147072, 0.12537209894508122,
                           -0.11441000252962112, -0.027828099206089973,
                           0.054492198303341864, -0.031601005047559735,
                           -0.1556639289483428, 0.09051580280065537,
                           -0.017843199148774146, 0.15601649768650533,
                           0.1185090035200119, 0.2851877994835377,
                           0.10274869874119759, -0.13653139881789683,
                           0.2611920468974859, 0.18572670519351958,
                           -0.05730680003762245, -0.04438519924879074,
                           -0.05721670016646385, 0.08867980130016803,
                           0.06317140087485314, -0.07060380056500434,
                           0.09534170255064964, -0.022160498425364494,
                           -0.2442654088139534, 0.03421511638443917,
                           -0.05913619659841061, -0.012261999351903797,
                           -0.0653474984690547, -0.11747500151395798,
                           -0.0979163602925837, -0.15988899916410446,
                           0.03697189763188362, 0.03945380225777626,
                           0.15216219648718834, -0.179976798966527,
                           -0.17194120311178268, 0.20189400240778924,
                           -0.09339540265500546, -0.020411701686680318,
                           0.07985850088298321, -0.12497000023722649,
                           -0.007269638008438051, -0.06740134111605585,
                           0.12203380689024926, -0.0887613020837307,
                           -0.03482718062587083, -0.06529909837990999,
                           -0.14841685134451837, -0.21464900076389312,
                           0.14549409672617913, -0.12108899801969528,
                           0.03502209968864918, 0.1732391005381942,
                           -0.04171069093281403, 0.13941810354590417,
                           0.11927980221807957, -0.3755987312179059,
                           0.11309369765222073, -0.06983049996197224,
                           0.07245379332453013, 0.004384005069732666,
                           0.13380939746275544, 0.012805630057118832,
                           0.18836700338870288, 0.09829520117491483,
                           0.11412100018933416, 0.04676170013844967,
                           -0.15663399994373323, -0.03644599765539169,
                           -0.10822279676795006, -0.06447100774385035,
                           0.026782400161027908, 0.026229299418628216,
                           -0.21632829010486604, -0.045539101399481294,
                           -0.09707579538226127, 0.050575497932732104,
                           -0.1040886990725994, -4.2697787284851076e-05,
                           -0.00276819858700037, 0.09070262114983052,
                           -0.1576729014515877, 0.33639599978923795,
                           -0.0645606788340956, -0.14988519866019487,
                           0.180862302146852, 0.0953620046377182,
                           -0.15704320110380648, -0.20498600155115126,
                           -0.1280836232297588, -0.013848802447319031,
                           -0.05298150844173506, 0.041356900706887245,
                           -0.17329762992449105, -0.11694340109825134,
                           0.023423603922128677, -0.2843899972736835,
                           0.04980040341615677, -0.15227599889039994,
                           -0.09185449723154307, 0.10263849813491106,
                           -0.3765499979257584, 0.004277100972831249,
                           0.1534987986087799, 0.3178479976952076,
                           -0.11196209918707609, -0.033927100151777266,
                           0.03685850128531456, -0.034032604098320006,
                           0.06752350255846977, 0.18112729471176864,
                           0.0717055018991232, 0.17354399622417988,
                           -0.04409200064837933, -0.003120703622698784,
                           -0.006623300164937973, -0.11895129755139351,
                           -0.13210199624300004, 0.19986160099506378,
                           -0.11157570034265518, -0.019748403504490853,
                           -0.13558799922466278, 0.12476480156183242,
                           0.12435759827494622, -0.026880798488855363,
                           -0.10776399970054626, 0.004921498335897922,
                           -0.07099682977423072, -0.30508520230650904,
                           -0.06696899831295014, -0.008720299880951642,
                           -0.04838949739933014, 0.18995853791711853,
                           0.06773356003686785, 0.160986802726984,
                           -0.17817769944667816, -0.04685720177367329,
                           -0.006087800115346908, -0.26296400725841523,
                           -0.1008239034563303, -0.03176009878516197,
                           0.0674464963376522, -0.11076369546353818,
                           0.09877090025693178, 0.0708560984581709,
                           -0.08528469949960708, 0.14859149465337396,
                           -0.061863600835204126, -0.21867629922926426,
                           -0.05903950110077858, 0.0024515013210475445,
                           0.5410320020280779, 0.025159399956464767,
                           -0.22847309615463018, 0.11669360026717186,
                           -0.04341911030933261, -0.19891435666941107,
                           -0.29270110428333285, -0.06465399898588657,
                           0.14111499935388566, 0.08679939694702625,
                           -0.15420039892196655, -0.0601929048076272,
                           0.07956099808216095, -0.25403830129653215,
                           0.06570860110223294, -0.13529404199216516,
                           -0.088850998878479, -0.2587766019627452,
                           -0.23158390074968338, -0.1324387975037098,
                           -0.013631302118301391, -0.09127012840472162,
                           -0.18321000039577484, -0.046965471981093285,
                           -0.15711903711780906, 0.27462510392069817,
                           0.003912004083395005, 0.045672500133514406,
                           0.04623100236058235, 0.02836079285480082,
                           0.11681639719754458, -0.04843409871682525],
                          [-0.06886808963661845, -7.163902575319463e-05,
                           0.0201141835952347, 0.012816088697449728,
                           -0.11526572653515772, -0.06309007294476032,
                           -0.04391727156259797, -0.0649025436829437,
                           -0.030894725160165268, 1.1052500063722783,
                           -0.21699880525490947, -0.08667618307200345,
                           0.022815729237415573, 0.011627001518552954,
                           -0.05090227469124577, 0.05964099835943092,
                           -0.14194645123048263, 0.3202452798458663,
                           0.06758363274010745, -0.03780718147754669,
                           0.035817091607234695, -0.054894451051950455,
                           0.04750572754578157, 0.0029936354946006427,
                           0.04645618152889339, -0.031723634763197464,
                           0.00404000079089945, 0.05785454327071255,
                           -0.012850090183994987, 0.16186228331009095,
                           0.004511755234985189, 0.1659312094985084,
                           0.050790926843712274, 0.11581717973405664,
                           0.09342727200551466, -0.06488463892178102,
                           -0.019709636965258556, -0.02301605735820803,
                           -0.08912490011954849, 0.04580254429443316,
                           0.021591456268321384, 0.04768727584318681,
                           -0.009680273180658167, 0.02201763540506363,
                           0.07552545449950478, -0.05752009356563741,
                           -0.015867273915897716, 0.04992636348205534,
                           0.01409963450648568, 0.04716791127893058,
                           0.02145790918306871, 0.1052979960698973,
                           0.06789218092506583, -0.01985909231007099,
                           -0.1079720908945257, 0.06766145473176782,
                           -0.02090050009163943, 0.020535363392396408,
                           0.07391027293422005, -0.08927783321335235,
                           -0.04236690217459744, -0.03393872996622866,
                           0.08248981681059707, -0.02843272550539537,
                           0.10688827305354855, -0.07866990964182398,
                           -0.05765018341216174, 0.010042996230450544,
                           0.04287672889503566, -0.08812699873339046,
                           -0.04540909149430015, -0.013490001247687773,
                           0.007298997180028396, -0.02164818143302744,
                           0.19452208991755138, -0.16166136346080087,
                           -0.11565245281566273, 0.018963638015768745,
                           0.0059020901945504274, 0.2374130016700788,
                           -0.05687918107617985, 0.11197708682580428,
                           0.036834182387048546, -0.12138650210743601,
                           0.02608245543458245, -0.009851362217556347,
                           0.03342873548072847, -0.14769055220213803,
                           0.04592427238821983, -0.022730819034305485,
                           -0.004626726731657982, 0.12508838445964185,
                           -0.0526583633300933, 0.03542363829910755,
                           0.1537215452302586, -0.026227179914712906,
                           0.023660910061814568, 0.07563709027387878,
                           0.0021618191491473804, -0.018337000330740757,
                           -0.08683636378158223, -0.09887245585295287,
                           0.16470954736525362, -0.09567245773293755,
                           -0.01924826051849364, -0.47423363273794,
                           0.009748816066844896, 0.08881363408132033,
                           0.03480699971656908, 0.09709245779297569,
                           0.04374163496223363, 0.01591736281459982,
                           -0.040977431503547865, -0.03682090816172687,
                           -0.1853151819245382, 0.16504918614571745,
                           0.04012024419551546, 0.009018817408518358,
                           -0.2334250889041207, -0.10536791231821883,
                           -0.09874481775543907, -0.020721548998897724,
                           -0.021590542725541374, 0.08141185720027848,
                           -0.000534728000109846, 0.05769445645538243,
                           0.05144336345520886, -0.024930089119483124,
                           -0.09857242912138728, 0.05533136275004257,
                           -0.03693981705741449, -0.0008125471120530909,
                           0.02441800047050823, 0.04074063863266598,
                           -0.029576910151676697, -0.011231818659739061,
                           -0.08565027990632436, 0.04962254620411179,
                           -0.0427734548733993, -0.07547636567191644,
                           -0.8181938183578578, -0.011893275786529888,
                           0.13050345433029262, -0.06866572560234503,
                           0.054518544538454575, 0.07317845743488181,
                           0.009556326433084905, 0.13008218665014615,
                           -0.00012254511768167669, 0.08717663484540852,
                           0.024725181812589817, -0.007776364599439231,
                           -0.07070363583889874, 0.06439064036716115,
                           0.15190199559385126, 0.1276625438847325,
                           0.06314327161420476, -0.005226817320693623,
                           -0.05366491676646878, 0.09907672284506672,
                           0.021096819165078076, -0.04223118214444681,
                           0.06579881771044298, 0.17474791035056114,
                           0.03698436204682697, -0.23512009260329333,
                           0.11939890784296123, -0.14970991083166815,
                           0.03041109104048122, 0.06759009307081049,
                           0.03279354558749632, 0.09634672884236682,
                           0.15511735968969084, -0.10439327494664626,
                           0.017570622720416974, 0.12236159078946168,
                           0.02410277040590617, 0.05229418216781183,
                           0.042132926639169455, 0.01719454743645408,
                           0.04300727238031951, 0.00896509059450843,
                           0.053074456328018146, -0.1361268221993338,
                           0.013676002621650696, -0.02821518209847537,
                           0.009879089891910553, -0.05207627165046605,
                           -0.010231817479838024, -0.020463909953832626,
                           -0.09845827181230891, -0.08832654797218063,
                           0.003167726776816628, 0.036349181424487724,
                           0.050644837827845055, 0.00922090627930381,
                           0.050406003540212456, 0.0038224556906656785,
                           0.08804572610692545, 0.11181290955706076,
                           0.03751518035476858, 0.07914699732579968,
                           -0.0030448175966739655, -0.04067345403812148,
                           0.08063690703023564, 0.0005496374585411766,
                           0.0016618174585429106, 0.03529263694177975,
                           0.06654900278557431, -0.0025041834874586625,
                           0.07908251640302214, -0.10713818262923848,
                           0.0375372740355405, 0.014219911938363855,
                           -0.024210909550840206, -0.07326863723045046,
                           -0.05036674079548737, 0.13980108567259528,
                           -0.1379769112576138, 0.005297910930080848,
                           0.05807802868498997, 0.16747500070116736,
                           0.046145637265660545, 0.023562091995369305,
                           0.005190998315811157, -0.03499618037180467,
                           0.12699045037681406, 0.17301399565555833,
                           0.15690208700570193, 0.062039725821126594,
                           0.07400818169116974, 0.1029684545302933,
                           -0.11937657362696799, -0.10096418180248955,
                           -0.006414821202104742, -0.013575545596805487,
                           -0.02568463511257009, -0.001961592161519961,
                           0.038335997949947014, 0.09916727312586525,
                           0.07546654686501081, -0.05069454319097779,
                           0.12849882075732405, -0.12067727101120082,
                           0.22800627147609537, -0.04533827541904016,
                           0.052675643089142715, 0.04280009256167845,
                           -0.01327809217301282, 0.012916275046088478,
                           0.04230445572598414, 0.059250725263899025,
                           -0.04408563470298594, -0.09785854613239114,
                           -0.07587745074521411, 0.07823621820319783,
                           0.12555217861451887, -0.12339881773699414,
                           -0.03656572780825875, 0.026017636399377476,
                           -0.006651363589546897, 0.041481090540235695,
                           0.03706663406708024, 0.09244972425089641,
                           0.019634364003484898, -0.18594441340643575,
                           0.02713890871117738, 0.08779872843826358,
                           0.14896408671682532, 0.05397990650751374,
                           -0.07839736274697563, -0.005509726872498339,
                           -0.061896195550533856, 0.04351545734839006,
                           0.011834544891660864, 0.098603544248776,
                           0.14070036092942412, 0.054199363020333374,
                           0.052019638517363506, 0.06703808971426704,
                           0.01361618089404973, -0.06630109199746088,
                           0.12118273296139458, 0.08943323568779636,
                           -0.018577544357288967, 0.03995218263431029,
                           0.08693899722261862, 0.0057804562490094795,
                           0.021899209823459387, -0.04365791007876396,
                           -0.11470971010964025, 0.07977845587513664,
                           -0.09099999882958153, -0.034472090530801906,
                           0.0929267287931659, 0.17992081264541906,
                           0.05755854398012161, -0.043269358575344086,
                           -0.13349927301433953, 0.09409845205531879]],
                         columns=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13,
                                  14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24,
                                  25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
                                  36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46,
                                  47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57,
                                  58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68,
                                  69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79,
                                  80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90,
                                  91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101,
                                  102, 103, 104, 105, 106, 107, 108, 109, 110,
                                  111, 112, 113, 114, 115, 116, 117, 118, 119,
                                  120, 121, 122, 123, 124, 125, 126, 127, 128,
                                  129, 130, 131, 132, 133, 134, 135, 136, 137,
                                  138, 139, 140, 141, 142, 143, 144, 145, 146,
                                  147, 148, 149, 150, 151, 152, 153, 154, 155,
                                  156, 157, 158, 159, 160, 161, 162, 163, 164,
                                  165, 166, 167, 168, 169, 170, 171, 172, 173,
                                  174, 175, 176, 177, 178, 179, 180, 181, 182,
                                  183, 184, 185, 186, 187, 188, 189, 190, 191,
                                  192, 193, 194, 195, 196, 197, 198, 199, 200,
                                  201, 202, 203, 204, 205, 206, 207, 208, 209,
                                  210, 211, 212, 213, 214, 215, 216, 217, 218,
                                  219, 220, 221, 222, 223, 224, 225, 226, 227,
                                  228, 229, 230, 231, 232, 233, 234, 235, 236,
                                  237, 238, 239, 240, 241, 242, 243, 244, 245,
                                  246, 247, 248, 249, 250, 251, 252, 253, 254,
                                  255, 256, 257, 258, 259, 260, 261, 262, 263,
                                  264, 265, 266, 267, 268, 269, 270, 271, 272,
                                  273, 274, 275, 276, 277, 278, 279, 280, 281,
                                  282, 283, 284, 285, 286, 287, 288, 289, 290,
                                  291, 292, 293, 294, 295, 296, 297, 298, 299],
                         index=['recommender', 'warren', 'biden',
                                'machinelearning', 'brexit'])

    pd.testing.assert_frame_equal(utility.astype("float64"), solution)
    print("Success")

    print("Testing similarity: ", end="")
    solution = DataFrame([[1.0000000000000004, 0.1482048343392846,
                           0.2795813063078053, 0.7071925328668537,
                           0.37988977742403685],
                          [0.1482048343392846, 0.9999999999999997,
                           0.6511502105581992, 0.18492897550913753,
                           0.4700805613893001],
                          [0.2795813063078053, 0.6511502105581992,
                           1.0000000000000002, 0.3791593177658622,
                           0.6414505000391922],
                          [0.7071925328668537, 0.18492897550913753,
                           0.3791593177658622, 1.0, 0.49389592720300945],
                          [0.37988977742403685, 0.4700805613893001,
                           0.6414505000391922, 0.49389592720300945,
                           0.9999999999999996]],
                         columns=['recommender', 'warren', 'biden',
                                  'machinelearning', 'brexit'],
                         index=['recommender', 'warren', 'biden',
                                'machinelearning', 'brexit'])

    pd.testing.assert_frame_equal(similarity.astype("float64"), solution)
    print("Success")
